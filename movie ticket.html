<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>movie ticket</title>
</head>
<style>
    body{
    background-color:gray;
}
.center{
    
    padding: 20px;
    float: left;
}
.seat_container{
margin-top: 0;
}
.seat{
    background-color: aqua;
height: 30px;
width: 60px;
margin:4px;
border-top-left-radius: 20px;
border-top-right-radius: 20px;
} 
.seat.selected{
    background-color: green;
}
.seat.sold{
background-color: blue;
}
.seat:nth-of-type(4){
    margin-left: 20px;
}
.seat:nth-last-of-type(2){
    margin-right: 18px;
}
.seat:not(.sold):hover{
    cursor: pointer;
    transform: scale(1.2);
}
.showcase.seat:not(.sold):hover{
    cursor:default;
    transform: scale(1.5);
}
.showcase{
    display: flex;
    justify-content: center;
    margin-left:10px;
    align-items: center;
    margin-top: 10px;

}
.showcase small{
    margin-left: 2px;
}
.row{
    display: flex;;
}
.container{
    justify-content: center;
    margin-left: 600px;
    align-items: center;
    margin-top: 40px;

}
p.text{
    color:blue;
    font-size: 20px;
    
}
p span{
    color:darkred;
    font-size: 40px;

}
   
    

    </style>
<body>
    <div class="Home">
        <div id="movie">
                    <div class="center">
                        <img src ="images/avatar.jpg">
                          <div  value="100" class="name"><p>AVATAR 2</p></div>
                    <button onclick="onClickEvent()">Book</button></div>
                    </div>
        </div> 
        <div class="showcase">

            <div class="seat"></div>
                <small>Available</small>
    
              <div class="seat selected"></div>
             <small>selected</small>
             
              <div class="seat sold"></div>
                  <small>taken</small>
    
        </div>
              <div class="container">
                   <div class="row">
                    <div class="seat"></div>
                    <div class="seat"></div>
                    <div class="seat"></div>
                    <div class="seat"></div>
                    <div class="seat"></div>
                    <div class="seat "></div>
                    <div class="seat "></div>
                    <div class="seat"></div>
      
      
               </div>
               <div class="row">
                  <div class="seat"></div>
                  <div class="seat"></div>
                  <div class="seat"></div>
                  <div class="seat"></div>
                  <div class="seat"></div>
                  <div class="seat"></div>
                  <div class="seat"></div>
                  <div class="seat"></div>
                  
             </div>
      
             <div class="row">
              <div class="seat"></div>
              <div class="seat"></div>
              <div class="seat"></div>
              <div class="seat"></div>
              <div class="seat"></div>
              <div class="seat"></div>
              <div class="seat"></div>
              <div class="seat"></div>
              
         </div>
         
             <div class="row">
              <div class="seat"></div>
              <div class="seat"></div>
              <div class="seat"></div>
              <div class="seat"></div>
              <div class="seat sold"></div>
              <div class="seat sold"></div>          
              <div class="seat"></div>
              <div class="seat"></div>
         </div>
         <div class="row">
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat sold"></div>
          <div class="seat"></div>
          <div class="seat sold"></div>
          <div class="seat"></div>
          <div class="seat"></div>     
      </div><div class="row">
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          
      </div><div class="row">
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
         
      </div><div class="row">
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          
      </div><div class="row">
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          
      </div><div class="row">
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
         
      </div><div class="row">
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat sold"></div>
          <div class="seat sold"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          <div class="seat"></div>
          
      </div>
    
    
      <p class="text">you have selected seats :<span id="count">0</span> </p>
    
      <p class="text">seat for a price of RS. <span id="total">0</span> </p>
    
          
              </div>                 
                        
   </div>
   <script>
    
const container = document.querySelector('.container')
const seats = document.querySelectorAll('.row .seat:not(.sold)');
const count = document.getElementById("count");
const total = document.getElementById("total");
       
const ticketPrice = 100;

populateUI();

function updateSelectedCount() {

const selectedSeats = document.querySelectorAll('.row .seat.selected');
const seatIndex = [...selectedSeats].map((seat) => [...seats].indexOf(seat));

console.log(JSON.stringify(seatIndex));

localStorage.setItem('selectedSeats', JSON.stringify(seatIndex));

const selectedSeatsCount = selectedSeats.length;

     count.innerText = selectedSeatsCount;
     total.innerText = selectedSeatsCount * ticketPrice;
}
function populateUI(){
    
    let  soldSeats = JSON.parse(localStorage.getItem('soldSeats'));

    if(soldSeats !== null && soldSeats.length > 0){
        seats.forEach((seat,index) => {
            if(soldSeats.indexOf(index) > -1){
            seat.classList.add('sold');
        }  
        
    });
}
}


container.addEventListener('click', (e) => {
    if (e.target.classList.contains('seat') && !e.target.classList.contains('sold')) {
      e.target.classList.toggle('selected');
      updateSelectedCount();
    }
  });

  function onClickEvent(){

    const selectedSeats = document.querySelectorAll('.row .seat.selected');
    const soldSeats = document.querySelectorAll('.row .seat.sold');
    

    if(selectedSeats.length == 0){  
        alert("Please select atleast one seat to book");
    }
    else{  
        var newLine = "\n";
        var message = " Tickets Booked Successfully ";
        message = message + newLine;
        message = message + "Seat Selected : "+ selectedSeats.length;
        message = message + newLine;
        message = message + "Total Price : " + selectedSeats.length * ticketPrice; 
        alert(message);

        let  selectedSeatsIndex = [...selectedSeats].map((seat) => [...seats].indexOf(seat));
        let  soldSeatsIndex = [...soldSeats].map((seat) => [...seats].indexOf(seat));

        let takenSeats = selectedSeatsIndex.concat(soldSeatsIndex); 

        localStorage.setItem('soldSeats', JSON.stringify(takenSeats));
        location.reload(); 
    }


  }
  


   </script>
</body>
</html>
